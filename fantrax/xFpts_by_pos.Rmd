---
title: "xFpts"
author: "Christopher Adams"
date: "6/10/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(ggrepel)
```

## Data setup

```{r data_setup}
#load all player data for fbref.com
weekly_data_csv = "../data/fantrax_data/weekly.all_data_combined.no_double_gws.csv"
yearly_data_csv = "../data/fantrax_data/yearly.all_data_combined.csv"

weekly_data_df <- read_csv(file = weekly_data_csv, col_names = TRUE)
yearly_data_df <- read_csv(file = yearly_data_csv, col_names = TRUE)

# Only weeks where at least 60 minutes are played
min_60_min_df <- weekly_data_df[weekly_data_df$Min > 59,]
# Players that have started at least 5 games
summary_min_60_df <- min_60_min_df %>% 
  group_by(Player, Team, Position) %>%
  summarize(n = n(), min_total = sum(Min), sd = sd(FPts), mean = mean(FPts), total_fpts = sum(FPts), mean_minutes = mean(Min))

#only players with at least 5 starts
players_min_5_starts_summary_df <- summary_min_60_df[summary_min_60_df$n >= 5,]

player_min_5_starts_weekly_df <- min_60_min_df %>%
  filter(Player %in% players_min_5_starts_summary_df$Player)
nrow(player_min_5_starts_weekly_df)


```

## get xFpts

```{r gather_xfpt_df}


# load in just defenders
players_min_starts.defenders = players_min_5_starts_summary_df[players_min_5_starts_summary_df$Position == 'D',]
nrow(players_min_starts.defenders)
def_player_list <- players_min_starts.defenders$Player
length(def_player_list)

defenders_fbref_df <- read_csv('../data/fantrax_data/Def_min5starts.csv')
#clean sheet data
cs_df <- read_csv('../data/fantrax_data/game_results.csv')

#parse round into game week
defenders_fbref_df$game_week <- sapply(strsplit(defenders_fbref_df$Round, " "), function(x) (x[2]))

#merge on player and game week
defenders_min60_merged_df <- merge(min_60_min_df, defenders_fbref_df, by=c('Player', 'game_week'))

#just get the important stuff for clean sheets
all_cs_data_df <- data.frame('Squad' = c(cs_df$Home, cs_df$Away), 'xG_against' = c(cs_df$xG_1, cs_df$xG), 'game_week' = c(cs_df$Wk, cs_df$Wk))

#merge cs and defender data
defenders_min60_merged_cs_df <- merge(defenders_min60_merged_df, all_cs_data_df, by=c('Squad', 'game_week'))

#calculate xFpts from cs given xG against
defenders_min60_merged_cs_df$GAD_against <- ifelse(defenders_min60_merged_cs_df$xG_against - 0.25 < 0, 0, defenders_min60_merged_cs_df$xG_against - 0.25)

defenders_min60_merged_cs_df$normed_xg_against <- ifelse(defenders_min60_merged_cs_df$GAD_against <= 1.25, 1 - defenders_min60_merged_cs_df$GAD_against/1.25, 0)

#just defenders filter
defenders_min60_min600_merged_df <- defenders_min60_merged_cs_df %>%
  filter(Player %in% def_player_list)

#calculate xFpts for defenders
defenders_min60_merged_cs_df$xPts <- defenders_min60_merged_cs_df$FPts - (defenders_min60_merged_cs_df$G * 10 + defenders_min60_merged_cs_df$AT * 8 + defenders_min60_merged_cs_df$CS * 6 + defenders_min60_merged_cs_df$GAD * -2) + (as.numeric(defenders_min60_merged_cs_df$xG)* 10 + as.numeric(defenders_min60_merged_cs_df$xA) * 8 + as.numeric(defenders_min60_merged_cs_df$normed_xg_against)* 6 + as.numeric(defenders_min60_merged_cs_df$GAD_against) * -2)

#remove some extra defender columns
drops <- c("normed_xg_against","GAD_against", 'xG_against')
defenders_min60_merged_cs_df <- defenders_min60_merged_cs_df[ , !(names(defenders_min60_merged_cs_df) %in% drops)]

# midfielders

#load in just midfielders
players_min_starts.midfielders = players_min_5_starts_summary_df[players_min_5_starts_summary_df$Position == 'M',]
nrow(players_min_starts.midfielders)
mid_player_list <- players_min_starts.midfielders$Player

mids_fbref_df <- read_csv('../data/fantrax_data/Mid_min5starts.csv')

#parse round into game week
mids_fbref_df$game_week <- sapply(strsplit(mids_fbref_df$Round, " "), function(x) (x[2]))

#merge on player and game week
mids_min60_merged_df <- merge(min_60_min_df, mids_fbref_df, by=c('Player', 'game_week'))

#just a test to make sure nothing weird happend to the names
i <- mid_player_list %in% unique(mids_min60_merged_df$Player)
mid_player_list[!i]

# filter on the player names
mids_min60_min600_merged_df <- mids_min60_merged_df %>%
  filter(Player %in% mid_player_list)

#calculate xFpts for midfielders
mids_min60_merged_df$xPts <- mids_min60_merged_df$FPts - (mids_min60_merged_df$G * 9 + mids_min60_merged_df$AT * 6)
mids_min60_merged_df$xPts <- mids_min60_merged_df$xPts + (as.numeric(mids_min60_merged_df$xG)* 9 + as.numeric(mids_min60_merged_df$xA) * 6)

# forwards

#load in just forwards
players_min_starts.forwards = players_min_5_starts_summary_df[players_min_5_starts_summary_df$Position == 'F',]
nrow(players_min_starts.forwards)

for_player_list <- players_min_starts.forwards$Player

fwds_fbref_df <- read_csv('../data/fantrax_data/For_min5starts.csv')

#parse round into game week
fwds_fbref_df$game_week <- sapply(strsplit(fwds_fbref_df$Round, " "), function(x) (x[2]))

#merge on player and game week
fwds_min60_merged_df <- merge(min_60_min_df, fwds_fbref_df, by=c('Player', 'game_week'))

#filter on forward player list
fwds_min60_min600_merged_df <- fwds_min60_merged_df %>%
  filter(Player %in% for_player_list)

#calculate xFpts for forwards
fwds_min60_merged_df$xPts <- fwds_min60_merged_df$FPts - (fwds_min60_merged_df$G * 9 + fwds_min60_merged_df$AT * 6)
fwds_min60_merged_df$xPts <- fwds_min60_merged_df$xPts + (as.numeric(fwds_min60_merged_df$xG)* 9 + as.numeric(fwds_min60_merged_df$xA) * 6)

names(fwds_min60_merged_df)

#combine all the position dataframes into one
all_combined_df <- rbind(defenders_min60_merged_cs_df, fwds_min60_merged_df, mids_min60_merged_df)
```

#collect the data for with team postion information
```{r}
#make a summary file
summary_all_combined_df <- all_combined_df %>% 
  group_by(Team, Pos) %>%
  summarize(n = n(), num_diff_players = length(unique(Player)) , min_total = sum(Min.x), sd_emp_pts = sd(FPts), sd_xpts = sd(xPts),   mean_emp_pts = mean(FPts), mean_xPts = mean(xPts), med_emp_pts= median(FPts), med_xPts = median(xPts), total_emp_fpts = sum(FPts),   total_xPts = sum(xPts), mean_minutes = mean(Min.x))

#remove team positions that do not have at least 10 occurances (mainly to remove the double position entries)
min_10_examples <- summary_all_combined_df[summary_all_combined_df$n >= 10,]

min_10_examples$Team_Pos <- paste(min_10_examples$Team, min_10_examples$Pos, sep = "_")

#write to file
write.csv(x=min_10_examples, file="../data/fantrax_data/pos_group.csv")


# collecting the team position data but keep the players
all_combined_Team_Pos <- all_combined_df
all_combined_Team_Pos$Team_Pos <- paste(all_combined_df$Team, all_combined_df$Pos, sep = "_")

dim(all_combined_Team_Pos)
#[1] 5291  130

#filter out any team positions that have not occurred 10 times
all_combined_Team_Pos_min_10 <- all_combined_Team_Pos %>% group_by(Team_Pos) %>% filter(n()> 10)


dim(all_combined_Team_Pos_min_10)
#[1] 4482  130

length(unique(all_combined_Team_Pos_min_10$Team_Pos))
#[1] 147

#try plotting it by team position
#xFpts plot
ggplot(all_combined_Team_Pos_min_10, aes(x = reorder(Team_Pos, xPts, FUN = median ), y = xPts)) + geom_boxplot()  + theme_minimal() + theme(axis.text.x = element_text(angle = 90)) +ggtitle("xFpts for Team Positions")

#Fpts plot
ggplot(all_combined_Team_Pos_min_10, aes(x = reorder(Team_Pos, FPts, FUN = median ), y = FPts)) + geom_boxplot()  + theme_minimal() + theme(axis.text.x = element_text(angle = 90)) +ggtitle("Fpts for Team Positions")
```


#test if there are positions where it doesn't matter which player is actually playing
```{r}
#require that 2 or more separate players have played the position (in order to 
all_combined_Team_Pos_min_10_players_2 <- all_combined_Team_Pos_min_10 %>% group_by(Team_Pos) %>% filter(length(unique(Player)) > 1)

dim(all_combined_Team_Pos_min_10_players_2)
#[1] 4328  130

length(unique(all_combined_Team_Pos_min_10_players_2$Team_Pos))
#[1] 140

ggplot(all_combined_Team_Pos_min_10_players_2, aes(x = reorder(Team_Pos, xPts, FUN = median ), y = xPts)) + geom_boxplot()  + theme_minimal() + theme(axis.text.x = element_text(angle = 90)) +ggtitle("xFpts for Team Positions")

#Fpts plot
ggplot(all_combined_Team_Pos_min_10_players_2, aes(x = reorder(Team_Pos, FPts, FUN = median ), y = FPts)) + geom_boxplot()  + theme_minimal() + theme(axis.text.x = element_text(angle = 90)) +ggtitle("Fpts for Team Positions")

#test the statistic for just 1 example

team_pos_vec <- unique(all_combined_Team_Pos_min_10_players_2$Team_Pos)

team_pos <- team_pos_vec[1]

team_pos_player <- all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == team_pos,]

k_test <- kruskal.test(xPts ~ Player, data = team_pos_player) 

#check if the Kruskal-Wallis test is close to bonferroni significant
bool_signif <- k_test$p.value < 0.05
```

#loop through the team positions and run Kruskal-Wallis test (non-parametric one way ANOVA) on each
```{r}

team_pos_vec <- unique(all_combined_Team_Pos_min_10_players_2$Team_Pos)

#length of the team_pos_vec
n = length(team_pos_vec)

#initiate a vector to save the boolean of whether the Kruskal-Wallis test was significant for each position (test of whether the player distributions seem to be the same)
sigKWTestList <- vector(mode= "list", length= n)

#for each team position
for(t in 1:length(team_pos_vec)){
  
  print(team_pos_vec[t])
  
  #set team_pos
  team_pos <- team_pos_vec[t]
  
  #filter all_combined_Team_Pos_min_10_players_2 to just the entries of players with this team_pos
  team_pos_player <- all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == team_pos,]
  
  k_test <- kruskal.test(xPts ~ Player, data = team_pos_player)
  print(k_test$p.value)

  #check if the Kruskal-Wallis test is close to bonferroni significant
  bool_signif <- k_test$p.value < 0.05
  
  #write the team pos test significance to the list
  sigKWTestList[[t]] <- bool_signif
}

#make the list into a vector
sigKWTestVec <- unlist(sigKWTestList)


#players seem to be distributed differently for these team distributions

team_pos_vec[sigKWTestVec]
# [1] "ARS_RB" "CRY_CM" "MCI_CB" "MUN_CB" "NOR_CB" "WOL_CB" "WOL_WB" "NEW_CM" "NEW_AM" "WHU_CM" "LEI_CM" "CRY_FW" "SOU_FW" "BUR_CM" "BOU_CM"
#[16] "MUN_LW" "MUN_AM" "MCI_CM" "WOL_DM" "CHE_DM" "NOR_AM"

# no statistical difference between players for these positions
team_pos_vec_players_same <- team_pos_vec[!sigKWTestVec]
#  [1] "ARS_CB" "ARS_LB" "AVL_RB" "AVL_CB" "AVL_LB" "AVL_WB" "AVL_CM" "BOU_CB" "BOU_LB" "BOU_RB" "BHA_CB" "BHA_WB" "BHA_LB" "BHA_RB" "BUR_LB"
# [16] "BUR_RB" "BUR_CB" "CHE_RB" "CHE_CB" "CHE_LB" "CRY_RB" "CRY_CB" "CRY_LB" "EVE_CB" "EVE_RB" "EVE_CM" "LEI_CB" "LEI_LB" "LIV_LB" "LIV_CB"
# [31] "MCI_RB" "MCI_LB" "MUN_LB" "NEW_CB" "NEW_WB" "NEW_LB" "NOR_LB" "NOR_RB" "SHU_CB" "SHU_CM" "SHU_WB" "SOU_CB" "TOT_CB" "TOT_RB" "WAT_RB"
# [46] "WAT_LB" "WAT_CB" "WAT_WB" "WHU_LB" "WHU_RB" "WHU_CB" "BHA_FW" "WOL_RW" "ARS_FW" "MUN_FW" "BUR_FW" "LEI_FW" "SHU_FW" "ARS_LW" "CHE_RW"
# [61] "CHE_LW" "BOU_FW" "EVE_FW" "MCI_FW" "MCI_LW" "WAT_FW" "WAT_LW" "BHA_LW" "TOT_FW" "WAT_CM" "WAT_RW" "NEW_FW" "LIV_RW" "LIV_FW" "ARS_CM"
# [76] "ARS_RW" "CHE_FW" "WOL_FW" "WOL_LW" "EVE_RW" "LIV_LW" "WHU_FW" "TOT_LW" "TOT_CM" "BHA_DM" "BHA_CM" "AVL_FW" "CHE_AM" "WAT_DM" "WAT_AM"
# [91] "LIV_CM" "NOR_CM" "NOR_DM" "EVE_DM" "MUN_DM" "AVL_RW" "AVL_LW" "BUR_DM" "MCI_RW" "AVL_DM" "ARS_DM" "ARS_AM" "WHU_DM" "TOT_AM" "LEI_DM"
#[106] "NOR_RW" "NOR_LW" "TOT_DM" "LIV_DM" "WHU_AM" "MUN_CM" "MCI_DM" "NEW_DM" "CRY_DM" "SOU_CM" "SOU_DM" "BOU_DM" "WOL_CM" "CHE_CM"

length(team_pos_vec_players_same)
#[1] 119

#filter so it is only team pos that there is no statistical difference in players
team_pos_players_same_df <- all_combined_Team_Pos_min_10_players_2[ all_combined_Team_Pos_min_10_players_2$Team_Pos %in% team_pos_vec_players_same,]

dim(team_pos_players_same_df)
#[1] 3370  130

#grab defenders
team_pos_players_same_def_df <- team_pos_players_same_df[team_pos_players_same_df$Position == "D",]

dim(team_pos_players_same_def_df)
#[1] 1642  130

#graph the defenders
ggplot(team_pos_players_same_def_df, aes(x = reorder(Team_Pos, xPts, FUN = median ), y = xPts)) + geom_boxplot()  + theme_minimal() + theme(axis.text.x = element_text(angle = 90)) +ggtitle("Defenders xFpts for Team Positions with no stat difference btw players")

#grab midfielders
team_pos_players_same_mid_df <- team_pos_players_same_df[team_pos_players_same_df$Position == "M",]

#graph the midfielders
ggplot(team_pos_players_same_mid_df, aes(x = reorder(Team_Pos, xPts, FUN = median ), y = xPts)) + geom_boxplot()  + theme_minimal() + theme(axis.text.x = element_text(angle = 90)) +ggtitle("Midfielders xFpts for Team Positions with no stat difference btw players")

dim(team_pos_players_same_mid_df)
#[1] 1068  130

#grab forwards
team_pos_players_same_for_df <- team_pos_players_same_df[team_pos_players_same_df$Position == "F",]

dim(team_pos_players_same_for_df)
#[1] 660 130

#graph the forwards
ggplot(team_pos_players_same_for_df, aes(x = reorder(Team_Pos, xPts, FUN = median ), y = xPts)) + geom_boxplot()  + theme_minimal() + theme(axis.text.x = element_text(angle = 90)) +ggtitle("Forwards xFpts for Team Positions with no stat difference btw players")
```

#Look into the statistically different team positions
```{r}

team_pos_vec[sigKWTestVec]
# [1] "ARS_RB" "CRY_CM" "MCI_CB" "MUN_CB" "NOR_CB" "WOL_CB" "WOL_WB" "NEW_CM" "NEW_AM" "WHU_CM" "LEI_CM" "CRY_FW" "SOU_FW" "BUR_CM" "BOU_CM"
#[16] "MUN_LW" "MUN_AM" "MCI_CM" "WOL_DM" "CHE_DM" "NOR_AM"

#look at ARS RBs
ARS_RB_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "ARS_RB",])

ggplot(ARS_RB_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = ARS_RB_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("Arsenal RB xFpt for each player")

#CRY_CM
CRY_CM_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "CRY_CM",])

ggplot(CRY_CM_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = CRY_CM_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("CRY_CM xFpt for each player")
#Wilf Zaha is good, maybe some other stuff


#MCI_CB
MCI_CB_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "MCI_CB",])

ggplot(MCI_CB_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = MCI_CB_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("MCI_CB xFpt for each player")
#Fernandinho is no good

#MUN_CB
MUN_CB_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "MUN_CB",])

ggplot(MUN_CB_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = MUN_CB_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("MUN_CB xFpt for each player")
#Victor Lidelof is worse than Slabhead

#NOR_CB
NOR_CB_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "NOR_CB",])

ggplot(NOR_CB_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = NOR_CB_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("NOR_CB xFpt for each player")
# Tettey and Godfrey are worse than Zimmerman and Hanley

#WOL_CB
WOL_CB_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "WOL_CB",])

ggplot(WOL_CB_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = WOL_CB_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("WOL_CB xFpt for each player")
#Willy Boly is better

#WOL_WB
WOL_WB_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "WOL_WB",])

ggplot(WOL_WB_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = WOL_WB_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("WOL_WB xFpt for each player")
#Doherty is good, jonny is okay

# NEW_CM
NEW_CM_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "NEW_CM",])

ggplot(NEW_CM_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = NEW_CM_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("NEW_CM xFpt for each player")
#Saint-Maximin is good, shelvey, ritchie, and almiron are pretty good

#NEW_AM
NEW_AM_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "NEW_AM",])

ggplot(NEW_AM_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = NEW_AM_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("NEW_AM xFpt for each player")
#Saint-Maximin is good, atsu might be good, almiron is not good

#WHU_CM
WHU_CM_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "WHU_CM",])

ggplot(WHU_CM_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = WHU_CM_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("WHU_CM xFpt for each player")
#anderson is good Noble is bad

#LEI_CM
LEI_CM_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "LEI_CM",])

ggplot(LEI_CM_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = LEI_CM_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("LEI_CM xFpt for each player")
#barnes and Maddison are about the same

#CRY_FW
CRY_FW_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "CRY_FW",])

ggplot(CRY_FW_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = CRY_FW_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("CRY_FW xFpt for each player")
#benteke better than the other two


#SOU_FW
SOU_FW_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "SOU_FW",])

ggplot(SOU_FW_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = SOU_FW_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("SOU_FW xFpt for each player")
#Shane long and Danny Ings about equal che Adams no good

#BUR_CM
BUR_CM_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "BUR_CM",])

ggplot(BUR_CM_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = BUR_CM_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("BUR_CM xFpt for each player")
#McNeil is good

#BOU_CM
BOU_CM_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "BOU_CM",])

ggplot(BOU_CM_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = BOU_CM_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("BOU_CM xFpt for each player")
#some are good some bad

#MUN_LW
MUN_LW_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "MUN_LW",])

ggplot(MUN_LW_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = MUN_LW_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("MUN_LW xFpt for each player")
#Rashford is way better than Daniel James

#MUN_AM
MUN_AM_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "MUN_AM",])

ggplot(MUN_AM_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = MUN_AM_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("MUN_AM xFpt for each player")
#Bruno and Pereira are good

#MCI_CM
MCI_CM_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "MCI_CM",])

ggplot(MCI_CM_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = MCI_CM_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("MCI_CM xFpt for each player")
#KDB is real good and Bernardo Silva is not so good

#WOL_DM
WOL_DM_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "WOL_DM",])

ggplot(WOL_DM_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = WOL_DM_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("WOL_DM xFpt for each player")
#Moutinho is good, don't bother with Dendoncker

#CHE_DM
CHE_DM_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "CHE_DM",])

ggplot(CHE_DM_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = CHE_DM_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("CHE_DM xFpt for each player")
#Kante is good

#NOR_AM

NOR_AM_data <- as.data.frame(all_combined_Team_Pos_min_10_players_2[all_combined_Team_Pos_min_10_players_2$Team_Pos == "NOR_AM",])

ggplot(NOR_AM_data, aes(Player, xPts)) + geom_boxplot(aes(colour = Player), outlier.shape = NA) + geom_jitter(width = 0.2, aes(colour = NOR_AM_data$Player)) + theme_minimal() + theme(axis.text.x = element_text(angle = 45)) +ggtitle("NOR_AM xFpt for each player")
#Duda looks to be good